<!DOCTYPE html>
<html>
  <head>
    <title>Survey Data Table</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #f0f5ff;
        /* Light blue background */
      }

      button {
        background-color: #3498db;
        color: white;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        background-color: white;
        /* White table background */
      }

      th,
      td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
      }

      th {
        background-color: #3498db;
        color: white;
      }

      tr:nth-child(even) {
        background-color: #ebf0ff;
        /* Light blue alternate row background */
      }

      @media screen and (max-width: 600px) {
        table {
          border: 0;
        }

        tr {
          margin-bottom: 10px;
          display: block;
          border: 1px solid #ccc;
        }

        td {
          border: none;
          border-bottom: 1px solid #ccc;
          position: relative;
          padding-left: 50%;
          background-color: #ebf0ff;
          /* Light blue alternate row background */
        }

        td:before {
          position: absolute;
          left: 6px;
          content: attr(data-label);
          background-color: #a1c8ff;
          /* Light blue header background */
          color: white;
        }
      }
      h1 {
        background-color: #3498db;
        color: white;
        text-align: center;
        padding: 20px;
        margin: 0;
      }
      #pagination-container {
        text-align: center;
        margin-top: 20px;
      }

      #prev-button,
      #next-button,
      #page-numbers button {
        background-color: #3498db;
        color: white;
        padding: 5px 10px;
        border: none;
        cursor: pointer;
        margin: 2px;
        border-radius: 3px;
      }

      #prev-button,
      #next-button {
        background-color: #333;
      }

      #prev-button:hover,
      #next-button:hover {
        background-color: #555;
      }

      #page-numbers button:hover {
        background-color: #555;
      }
    </style>
  </head>

  <body>
    <h1>Response</h1>
    <div class="table-container">
      <div class="date-filter">
        <label for="start-date">Start Date:</label>
        <input type="date" id="start-date" />
        <label for="end-date">End Date:</label>
        <input type="date" id="end-date" />
        <button id="filter-button">Apply Filter</button>
      </div>

      <table>
        <thead>
          <tr>
            <th>Serial No</th>
            <!-- Add a new column for Serial No -->
            <th data-label="ID">ID</th>
            <th data-label="Timestamp">Timestamp</th>
            <th data-label="Mobile Number">Mobile Number</th>
            <th data-label="Gender">Gender</th>
            <th data-label="Urban or Rural">Urban or Rural</th>
            <th data-label="Upcoming Election Party">
              Upcoming Election Party
            </th>
            <th data-label="Party 2018">Party 2018</th>
            <th data-label="Satisfaction with CM">Satisfaction with CM</th>
            <th data-label="Satisfaction with MLA">Satisfaction with MLA</th>
            <th data-label="Occupation">Occupation</th>
            <th data-label="Caste">Caste</th>
            <th data-label="Agent ID">Agent ID</th>
            <th data-label="Remarks (if any)">Remarks (if any)</th>
            <th data-label="Action">Action</th>
            <!-- Add a new column for the Delete button -->
          </tr>
        </thead>
        <tbody>
          <% data.forEach(function(entry, index) { %>
          <tr>
            <td><%= index + 1 %></td>
            <!-- Serial number starts from 1 -->
            <td data-label="ID"><%= entry.Id %></td>
            <td data-label="Timestamp"><%= entry.Timestamp %></td>
            <td data-label="Mobile Number"><%= entry.Mobile_Number %></td>
            <td data-label="Gender"><%= entry.Gender %></td>
            <td data-label="Urban or Rural"><%= entry.Urban_or_Rural %></td>
            <td data-label="Upcoming Election Party">
              <%= entry.Upcoming_Election_Party %>
            </td>
            <td data-label="Party 2018"><%= entry.Party_2018 %></td>
            <td data-label="Satisfaction with CM">
              <%= entry.Satisfaction_with_CM %>
            </td>
            <td data-label="Satisfaction with MLA">
              <%= entry.Satisfaction_with_MLA %>
            </td>
            <td data-label="Occupation"><%= entry.Occupation %></td>
            <td data-label="Caste"><%= entry.Caste %></td>
            <td data-label="Agent ID"><%= entry.Agent_ID %></td>
            <td data-label="Remarks (if any)"><%= entry.Remarks_if_any %></td>
            <td data-label="Action">
              <form action="/deleteSurveyData" method="POST">
                <input type="hidden" name="id" value="<%= entry.Id %>" />
                <button type="submit">Delete</button>
              </form>
            </td>
          </tr>
          <% }); %>
        </tbody>
      </table>
      <div id="pagination-container">
        <button id="prev-button"><<</button>
        <span id="page-numbers"></span>
        <button id="next-button">>></button>
      </div>

      <script>
        const table = document.querySelector("table");
        const tableRows = table.querySelectorAll("tr");
        const rowsPerPage = 10;
        let currentPage = 1;

        function displayTable(page) {
          const start = (page - 1) * rowsPerPage;
          const end = start + rowsPerPage;

          // Create HTML for the table rows to display
          let tableHtml = "";
          for (let i = start; i < end; i++) {
            if (tableRows[i]) {
              tableHtml += tableRows[i].outerHTML;
            }
          }

          table.innerHTML = `
                 
                    ${tableHtml}
                `;
        }

        function navigateToPage(page) {
          if (page < 1) page = 1;
          if (page > Math.ceil(tableRows.length / rowsPerPage))
            page = Math.ceil(tableRows.length / rowsPerPage);
          currentPage = page;
          displayTable(currentPage);
        }

        displayTable(currentPage);

        const paginationContainer = document.getElementById(
          "pagination-container"
        );
        const totalPages = Math.ceil(tableRows.length / rowsPerPage);
        const pageNumbers = document.getElementById("page-numbers");
        const prevButton = document.getElementById("prev-button");
        const nextButton = document.getElementById("next-button");

        function updatePageNumbers() {
          pageNumbers.innerHTML = "";
          for (let i = 1; i <= totalPages; i++) {
            const button = document.createElement("button");
            button.innerText = i;
            button.addEventListener("click", () => navigateToPage(i));
            pageNumbers.appendChild(button);
          }
        }

        updatePageNumbers();

        prevButton.addEventListener("click", () => {
          navigateToPage(currentPage - 1);
        });

        nextButton.addEventListener("click", () => {
          navigateToPage(currentPage + 1);
        });
      </script>
     <script>
        document.getElementById("filter-button").addEventListener("click", applyFilter);
      
        function applyFilter() {
          const startDate = new Date(document.getElementById("start-date").value);
          const endDate = new Date(document.getElementById("end-date").value);
      
          if (!startDate || !endDate || startDate > endDate) {
            alert("Invalid date range. Please select valid dates.");
            return;
          }
      
          const table = document.querySelector("table");
          const tableRows = table.querySelectorAll("tr");
      
          tableRows.forEach((row) => {
            const timestampCell = row.querySelector("[data-label='Timestamp']");
            if (timestampCell) {
              const timestamp = new Date(timestampCell.textContent);
              if (timestamp >= startDate && timestamp <= new Date(endDate.getTime() + 24 * 60 * 60 * 1000)) {
                row.style.display = "table-row";
              } else {
                row.style.display = "none";
              }
            }
          });
        }
      </script>
      
    </div>
  </body>
</html>
 
 